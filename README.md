# flexy-monorepo

ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã¯ã€**ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸è‡ªå‹•æ§‹ç¯‰ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ **ã‚’æ§‹æˆã™ã‚‹è¤‡æ•°ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä¸€å…ƒçš„ã«ç®¡ç†ã™ã‚‹ Monorepo ã§ã™ã€‚  
å„ã‚µãƒ¼ãƒ“ã‚¹ã¯ç‹¬ç«‹ã—ãŸè²¬å‹™ã‚’æŒã¡ãªãŒã‚‰ã€Cloudflareãƒ»Google Cloud ä¸Šã§ç–çµåˆã«é€£æºã—ã€  
ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒãƒ¼ã‚³ãƒ¼ãƒ‰ã§ã‚µã‚¤ãƒˆã‚’ç”Ÿæˆãƒ»é…ä¿¡ã§ãã‚‹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚

---

## ğŸ—ºï¸ System Overview

![System Overview](./docs/system-wide/overview.png)

ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã¯ä»¥ä¸‹ã®ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰æ§‹æˆã•ã‚Œã¾ã™ï¼š

| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | å½¹å‰² |
|----------------|------|
| **Rendering Engine (library)** | UI ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚’æ‹…å½“ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‚ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚„ãƒ‡ã‚¶ã‚¤ãƒ³æ§‹æˆã‚’å…¥åŠ›ã¨ã—ã¦ã€é™çš„/å‹•çš„ HTML ã‚’ç”Ÿæˆã€‚ |
| **Build & Deploy Pipeline** | Rendering Engine ã‚’åˆ©ç”¨ã—ã¦ãƒ“ãƒ«ãƒ‰ã‚’è¡Œã„ã€æˆæœç‰©ã‚’ Cloudflare ã¸ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã€‚ |
| **Supplier Console** | ã‚µã‚¤ãƒˆæä¾›è€…ï¼ˆäº‹æ¥­è€…ï¼‰ãŒæ§‹æˆãƒ»ãƒ†ãƒ¼ãƒãƒ»ãƒ‡ã‚¶ã‚¤ãƒ³ã‚’è¨­å®šã™ã‚‹ç®¡ç†ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã€‚ |
| **Delivery Pipeline** | æœ€çµ‚æˆæœç‰©ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸é…ä¿¡ã€‚Cloudflare Workers / KV / R2 ä¸Šã§ãƒ›ã‚¹ãƒˆã•ã‚Œã‚‹ã€‚ |
| **Data Layer** | Cloud SQL ã¨ Cloud Storage ã«ã‚ˆã‚Šè¨­å®šãƒ»æˆæœç‰©ãƒ»ãƒ­ã‚°ã‚’ä¸€å…ƒç®¡ç†ã€‚ |

> å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ API / Cloud Task ã‚’é€šã˜ã¦ç–çµåˆã«é€£æºã—ã¾ã™ã€‚  
> Host-based Routing ã«ã‚ˆã‚Šã€å„ãƒ†ãƒŠãƒ³ãƒˆï¼ˆé¡§å®¢ã‚µã‚¤ãƒˆï¼‰ã”ã¨ã«ç‹¬ç«‹ã—ãŸé…ä¿¡ãƒ«ãƒ¼ãƒˆã‚’å½¢æˆã—ã¾ã™ã€‚

---

## âš™ï¸ Architecture Summary

### Rendering Engine
- æ§‹æˆ: TypeScript è£½ Solidå‘ã‘ ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- ä¸»ãªç‰¹å¾´:
  - Declarative Rendering Pipeline
  - Compositional Rendering Architecture
  - Part / Block / Layout å±¤ã®åˆ†é›¢
- å…¥åŠ›: è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
- å‡ºåŠ›: Solidã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

### Build & Deploy Pipeline
- Cloud Run Jobs ã«ã‚ˆã‚Šãƒ“ãƒ«ãƒ‰ã‚¿ã‚¹ã‚¯ã‚’éåŒæœŸå®Ÿè¡Œã€‚
- æˆæœç‰©ã¯ Delivery Pipeline ç®¡è½„ã®Cloudflare R2ã«è»¢é€ã€‚
- ãƒ†ãƒŠãƒ³ãƒˆã¨ç‹¬è‡ªãƒ‰ãƒ¡ã‚¤ãƒ³ã®ç´ã¥ã‘è¨­å®šã‚’Cloudflare KVã«ä¿å­˜ã€‚

### Supplier Console
- ã‚µã‚¤ãƒˆæ§‹æˆãƒ»ãƒšãƒ¼ã‚¸ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ»ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ãªã©ã‚’ç·¨é›†å¯èƒ½ãªç®¡ç† UIã€‚
- Cloud Run API çµŒç”±ã§ Build & Deploy Pipeline ã‚’åˆ¶å¾¡ã€‚
- Identity Platform ã«ã‚ˆã‚‹èªè¨¼ã‚’åˆ©ç”¨ã€‚

### Delivery Pipeline
- Cloudflare Workers ã«ã‚ˆã‚‹é…ä¿¡ã‚¨ãƒƒã‚¸ã€‚
- Cloudflare KV (æ§‹æˆã‚­ãƒ£ãƒƒã‚·ãƒ¥) ã¨ R2 (é™çš„ãƒ•ã‚¡ã‚¤ãƒ«) ã‚’ä½¿ç”¨ã€‚
- Host-based Routing ã«ã‚ˆã‚Šé¡§å®¢ã”ã¨ã«ç‹¬ç«‹ã—ãŸã‚µã‚¤ãƒˆã‚’æä¾›ã€‚
